library(tidyverse)
houses <- read_csv("data/housing_prices.csv")
View(houses)
summary(houses)
glimpse(houses)
summary(houses)
glimpse(houses)
skimr::skim(houses)
?ggpair
??ggpair
library(GGally)
library(GGally)
ggpair(houses, columns = c(total_rooms, total_bedrooms))
ggpairs(houses, columns = c(total_rooms, total_bedrooms))
ggpairs(houses, columns = c("total_rooms", "total_bedrooms"))
houses_trim <- houses %>%
select(-total_bedrooms)
alias(median_house_value ~ ., houses)
ggpairs(houses_trim)
ggplot(houses, aes(median_income, median_house_value)) +
geom_point()
ggplot(houses, aes(median_income, median_house_value)) +
geom_point(alpha = 0.1)
ggplot(houses, aes(latitude, median_house_value)) +
geom_point(alpha = 0.1)
ggplot(houses, aes(total_rooms, median_house_value)) +
geom_point(alpha = 0.1)
ggplot(houses, aes(ocean_proximity, median_house_value)) +
geom_point(alpha = 0.1)
ggplot(houses, aes(ocean_proximity, median_house_value)) +
geom_boxplot()
model <- lm(
median_house_value ~ median_income,
data = houses
)
summary(model)
autoplot(model)
library(ggfortify)
ggpairs(houses_trim, progress = FALSE)
autoplot(model)
autoplot(model)
ggplot(house, aes(median_income, median_house_price)) +
geom_point() +
geom_smooth(method = "lm")
ggplot(houses, aes(median_income, median_house_price)) +
geom_point() +
geom_smooth(method = "lm")
ggplot(houses, aes(median_income, median_house_value)) +
geom_point() +
geom_smooth(method = "lm")
houses <- read_csv("data/housing_prices.csv")
ggplot(houses) +
geom_density(aes(x = median_house_value))
summary(houses)
ggplot(houses) +
geom_density(aes(x = median_house_value))
20640 - 19675
ggplot(houses, aes(median_income, median_house_value)) +
geom_point(alpha = 0.1) +
geom_smooth(method = "lm")
houses_dummy <- houses %>%
dummy_cols(select_columns = "ocean_proximity",
remove_first_dummy = TRUE)
library(fastDummies)
houses_dummy <- houses %>%
dummy_cols(select_columns = "ocean_proximity",
remove_first_dummy = TRUE)
View(houses_dummy)
model_2 <- lm(
median_house_value ~ median_income + ocean_proximity_ISLAND,
data = houses
)
model_2 <- lm(
median_house_value ~ median_income + ocean_proximity_ISLAND,
data = houses_dummy
)
summary(model_2)
summary(model_2)
autoplot(model_2)
ggplot(houses_dummy, aes(median_house_value, median_income,
colour = ocean_proximity_ISLAND)) +
geom_point()
library(mosaic)
library(mosaicData)
library(janitor)
library(tidyverse)
library(GGally)
library(ggfortify)
library(modelr)
dim(RailTrail)
head(RailTrail)
railtrail_clean <- RailTrail %>%
clean_names() %>%
rename(cloudage = cloudcover) %>%
mutate(across(spring:fall, as.logical))
# volume ~ . (. means every other variable)
alias(volume ~ ., data = railtrail_clean)
railtrail_trim <- railtrail_clean %>%
select(-c(lowtemp, hightemp, fall, day_type))
alias(volume ~ ., railtrail_trim)
ggpairs(railtrail_trim, progress = FALSE)
model <- lm(volume ~ avgtemp, data = railtrail_trim)
autoplot(model)
summary(model)
ggplot(railtrail_trim, aes(avgtemp, volume)) +
geom_point()
predict_at <- data.frame(avgtemp = 60)
predict(model, newdata = predict_at)
railtrail_trim %>%
add_predictions(model, var = "pred_height")
99.6 + 4.8 * 60
ggplot(railtrail_trim, aes(weekday, volume)) +
geom_boxplot()
railtrail_trim %>%
group_by(weekday) %>%
summarise(total = sum(volume)) %>%
ggplot(aes(weekday, total)) +
geom_col()
railtrail_trim %>%
summarise(cor = cor(weekday, volume))
model_2 <- lm(
volume ~ avgtemp + weekday,
data = railtrail_trim
)
autoplot(model_2)
summary(model_2)
plotModel(model_2)
model_3 <- lm(
volume ~ avgtemp + weekday + summer,
data = railtrail_trim
)
autoplot(model_3)
summary(model_3)
plotModel(model_3)
railtrail_trim %>%
ggplot(aes(x = avgtemp, y = volume, colour = weekday)) +
geom_point() +
geom_smooth(method = "lm", se = FALSE)
model_interactions <- lm(
formula = volume ~ avgtemp + weekday + avgtemp:weekday,
data = railtrail_trim
)
plotModel(model_interactions)
summary(model_interactions)
285.887 + (2.456 * 70) + (-262.193 * 1) + (3.3 * 70 * 1)
286.887 + (2.457 * 70)
autoplot(model_interactions)
model_3terms <- lm(
volume ~ avgtemp + weekday + cloudage,
data = railtrail_trim
)
summary(model_3terms)
200.1022 + (5.2461 * 55) + (-16.0115 * 5)
c        + (a * x)         + (b * z)
plotModel(model_2)
library(tidyverse)
library(GGally)
library(ggfortify)
library(fastDummies)
houses <- read_csv("data/housing_prices.csv")
summary(houses)
glimpse(houses)
skimr::skim(houses)
ggpairs(houses, columns = c("total_rooms", "total_bedrooms"))
houses_trim <- houses %>%
select(-total_bedrooms)
ggpairs(houses_trim, progress = FALSE)
ggplot(houses, aes(median_income, median_house_value)) +
geom_point(alpha = 0.1)
ggplot(houses, aes(latitude, median_house_value)) +
geom_point(alpha = 0.1)
ggplot(houses, aes(total_rooms, median_house_value)) +
geom_point(alpha = 0.1)
ggplot(houses, aes(ocean_proximity, median_house_value)) +
geom_boxplot()
model <- lm(
median_house_value ~ median_income,
data = houses
)
summary(model)
autoplot(model)
ggplot(houses, aes(median_income, median_house_value)) +
geom_point(alpha = 0.1) +
geom_smooth(method = "lm")
ggplot(houses) +
geom_density(aes(x = median_house_value))
houses_dummy <- houses %>%
dummy_cols(select_columns = "ocean_proximity",
remove_first_dummy = TRUE)
model_2 <- lm(
median_house_value ~ median_income + ocean_proximity_ISLAND,
data = houses_dummy
)
summary(model_2)
autoplot(model_2)
ggplot(houses_dummy, aes(median_house_value, median_income,
colour = ocean_proximity_ISLAND)) +
geom_point()
plotModel(model_2)
View(houses_dummy)
View(houses_dummy)
railtrail_clean <- RailTrail %>%
clean_names() %>%
rename(cloudage = cloudcover) %>%
mutate(across(spring:fall, as.logical))
railtrail_trim <- railtrail_clean %>%
select(-c(lowtemp, hightemp, fall, day_type))
alias(volume ~ ., railtrail_trim)
View(railtrail_trim)
RailTrail
View(houses_dummy)
houses_dummy <- houses %>%
dummy_cols(select_columns = "ocean_proximity",
remove_first_dummy = TRUE) %>%
mutate(across(ocean_proximity_INLAND:ocean_proximityNEAROCEAN, as.logical))
houses_dummy <- houses %>%
dummy_cols(select_columns = "ocean_proximity",
remove_first_dummy = TRUE) %>%
mutate(across(ocean_proximity_INLAND:ocean_proximityNEAR OCEAN, as.logical))
houses_dummy <- houses %>%
dummy_cols(select_columns = "ocean_proximity",
remove_first_dummy = TRUE) %>%
mutate(across(ocean_proximity_INLAND:ocean_proximityNEAR_OCEAN, as.logical))
houses_dummy <- houses %>%
dummy_cols(select_columns = "ocean_proximity",
remove_first_dummy = TRUE) %>%
janitor::clean_names()
houses_dummy
houses_dummy <- houses %>%
dummy_cols(select_columns = "ocean_proximity",
remove_first_dummy = TRUE) %>%
janitor::clean_names() %>%
mutate(across(ocean_proximity_inland:ocean_proximity_near_ocean, as.logical))
View(houses_dummy)
model_2 <- lm(
median_house_value ~ median_income + ocean_proximity_island,
data = houses_dummy
)
summary(model_2)
plotModel(model_2)
house_dummy %>%
filter(ocean_proximity_island) %>%
summarise(total = n())
house_dummy %>%
filter(ocean_proximity_island == TRUE) %>%
summarise(total = n())
houses_dummy %>%
filter(ocean_proximity_island == TRUE) %>%
summarise(total = n())
houses_dummy %>%
group_by(ocean_proximity) %>%
summarise(total = n())
model_3 <- lm(
median_house_value ~ median_income + ocean_proximity_inland,
data = houses_dummy
)
summary(model_3)
autoplot(model_3)
plotModel(model_3)
?plotModel
plotModel(model_3) + facet_wrap( ~ ocean_proximity_inland)
plotModel(model_3)
plotModel(model_3, alpha = 0.1)
model_interactions <- lm(
formula = median_house_value ~ median_income + ocean_proximity_inland
+ log(median_income):ocean_proximity_inland,
data = houses_dummy
)
summary(model_interactions)
plotModel(model_interactions)
model_interactions <- lm(
formula = median_house_value ~ median_income + ocean_proximity_inland + log(median_income):ocean_proximity_inland,
data = houses_dummy
)
summary(model_interactions)
autoplot(model_interactions)
model_interactions2 <- lm(
formula = median_house_value ~ log(median_income):ocean_proximity_inland,
data = houses_dummy
)
summary(model_interactions2)
autoplot(model_interactions2)
plotModel(model_interactions2)
ggplot(houses_dummy, aes(log(median_income), median_house_value,
colour = ocean_proximity_value)) +
geom_point()
ggplot(houses_dummy, aes(log(median_income), median_house_value,
colour = ocean_proximity_inland)) +
geom_point()
ggplot(houses_dummy, aes(log(median_income), median_house_value,
colour = ocean_proximity_inland, alpha = 0.1)) +
geom_point()
ggplot(houses_dummy, aes(log(median_income), median_house_value,
colour = ocean_proximity_inland, alpha = 0.1)) +
geom_point() +
geom_smooth(method = "lm")
View(houses_dummy)
houses_dummy %>%
mutate(mean_bedrooms = total_bedrooms / households)
houses_dummy %>%
mutate(mean_bedrooms = total_bedrooms / households, .after = total_rooms)
houses_dummy %>%
mutate(mean_rooms = total_rooms / households, .after = total_rooms)
houses_dummy <- houses_dummy %>%
mutate(mean_rooms = total_rooms / households, .after = total_rooms)
model_4 <- lm(
median_house_value ~ median_income + ocean_proximity_inland + mean_rooms,
data = houses_dummy
)
summary(model_4)
library(tidyverse)
library(GGally)
library(ggfortify)
library(fastDummies)
library(mosaic)
View(houses_dummy)
