data = houses_dummy
)
summary(model_interactions2)
autoplot(model_interactions2)
plotModel(model_interactions2)
ggplot(houses_dummy, aes(log(median_income), median_house_value,
colour = ocean_proximity_value)) +
geom_point()
ggplot(houses_dummy, aes(log(median_income), median_house_value,
colour = ocean_proximity_inland)) +
geom_point()
ggplot(houses_dummy, aes(log(median_income), median_house_value,
colour = ocean_proximity_inland, alpha = 0.1)) +
geom_point()
ggplot(houses_dummy, aes(log(median_income), median_house_value,
colour = ocean_proximity_inland, alpha = 0.1)) +
geom_point() +
geom_smooth(method = "lm")
View(houses_dummy)
houses_dummy %>%
mutate(mean_bedrooms = total_bedrooms / households)
houses_dummy %>%
mutate(mean_bedrooms = total_bedrooms / households, .after = total_rooms)
houses_dummy %>%
mutate(mean_rooms = total_rooms / households, .after = total_rooms)
houses_dummy <- houses_dummy %>%
mutate(mean_rooms = total_rooms / households, .after = total_rooms)
model_4 <- lm(
median_house_value ~ median_income + ocean_proximity_inland + mean_rooms,
data = houses_dummy
)
summary(model_4)
library(tidyverse)
library(GGally)
library(ggfortify)
library(fastDummies)
library(mosaic)
View(houses_dummy)
library(tidyverse)
library(GGally)
library(ggfortify)
library(fastDummies)
library(mosaic)
library(leaflet)
houses <- read_csv("data/housing_prices.csv")
top10_houses <- houses %>%
slice(max(median_house_value))
View(top10_houses)
top10_houses <- houses %>%
slice_max(median_house_value, 10)
top10_houses <- houses %>%
slice_max(median_house_value, n = 10)
View(top10_houses)
houses %>%
filter(median_house_value = 50000)
houses %>%
filter(median_house_value == 50000)
View(houses)
bottom10_houses <- houses %>%
slice_min(median_house_value, n = 10)
View(bottom10_houses)
leaflet() %>%
addTiles() %>%
addCircles(lng = top11_houses$longitude, lat = top11_houses$latitude)
houses %>%
filter(median_house_value == 50000)
top11_houses <- houses %>%
filter(median_house_value == 50000)
leaflet() %>%
addTiles() %>%
addCircles(lng = top11_houses$longitude, lat = top11_houses$latitude)
leaflet() %>%
addTiles() %>%
addCircles(lng = top11_houses$longitude, lat = top11_houses$latitude) %>%
addCircles(lng = bottom10_houses$longitude, lat = bottom10_houses$latitude)
leaflet() %>%
addTiles() %>%
addCircles(lng = top11_houses$longitude, lat = top11_houses$latitude) %>%
addCircles(lng = bottom10_houses$longitude, lat = bottom10_houses$latitude,
colour = "red")
?addCircles
leaflet() %>%
addTiles() %>%
addCircles(lng = top11_houses$longitude, lat = top11_houses$latitude) %>%
addCircles(lng = bottom10_houses$longitude, lat = bottom10_houses$latitude,
fillColor = "red")
leaflet() %>%
addTiles() %>%
addCircles(lng = top11_houses$longitude, lat = top11_houses$latitude) %>%
addCircles(lng = bottom10_houses$longitude, lat = bottom10_houses$latitude,
fillColor = "red", color = "red")
houses %>%
mutate(rooms_per_house = total_rooms / households,
people per house = population / households,
house_log <- house %>%
select(-c(latitude, longitude, ocean_proximity)) %>%
mutate(across(everything(), .fns = log))
house_log <- houses %>%
select(-c(latitude, longitude, ocean_proximity)) %>%
mutate(across(everything(), .fns = log))
houses %>%
mutate(rooms_per_house = total_rooms / households,
people_per_house = population / households,
bedrooms_per_house = total_bedrooms / households,
bedrooms_per_person = total_bedrooms / population,
rooms_per_person = total_rooms / population,
# non_bedrooms = total_rooms - total_bedrooms,
prop_bedrooms = total_bedrooms / total_rooms)
houses %>%
mutate(rooms_per_house = total_rooms / households,
people_per_house = population / households,
bedrooms_per_house = total_bedrooms / households,
bedrooms_per_person = total_bedrooms / population,
rooms_per_person = total_rooms / population,
# non_bedrooms = total_rooms - total_bedrooms,
prop_bedrooms = total_bedrooms / total_rooms)
house_log <- houses %>%
select(-c(latitude, longitude, ocean_proximity)) %>%
mutate(across(everything(), .fns = log))
View(house_log)
house_augment <- house %>%
bind_rows(house_log, .id = "log")
house_augment <- houses %>%
bind_rows(house_log, .id = "log")
View(house_augment)
colnames(house_augment, prefix = "log")
colnames(house_augment) <- paste("log", colnames(house_augment), sep = "_")
house_augment
colnames(house_log) <- paste("log", colnames(house_log), sep = "_")
house_log
house_augment <- houses %>%
bind_cols(house_log)
View(house_augment)
houses <- houses %>%
mutate(rooms_per_house = total_rooms / households,
people_per_house = population / households,
bedrooms_per_house = total_bedrooms / households,
bedrooms_per_person = total_bedrooms / population,
rooms_per_person = total_rooms / population,
# non_bedrooms = total_rooms - total_bedrooms,
prop_bedrooms = total_bedrooms / total_rooms)
house_log <- houses %>%
select(-c(latitude, longitude, ocean_proximity)) %>%
mutate(across(everything(), .fns = log))
colnames(house_log) <- paste("log", colnames(house_log), sep = "_")
house_augment <- houses %>%
bind_cols(house_log)
ggpairs(house_augment)
ggpairs1 <- house_augment %>%
select(median_house_value, housing_median_age, median_income, ocean_proximity) %>%
ggpairs()
ggpair1
ggpairs1
ggpairs1 <- house_augment %>%
select(median_house_value, housing_median_age, median_income, ocean_proximity) %>%
ggpairs(progress = FALSE)
ggpairs1
```{r, warning = FALSE}
ggpairs1 <- house_augment %>%
select(median_house_value, housing_median_age, median_income, ocean_proximity) %>%
ggpairs(progress = FALSE)
ggpairs1
ggpairs1 <- house_augment %>%
select(median_house_value, housing_median_age, median_income, ocean_proximity) %>%
ggpairs(progress = FALSE)
ggpairs1
housing_prices %>%
ggplot() +
aes(y=latitude, x= longitude, colour = ocean_proximity) +
geom_point() +
scale_colour_brewer(palette = "Paired")
houses %>%
ggplot() +
aes(y=latitude, x= longitude, colour = ocean_proximity) +
geom_point() +
scale_colour_brewer(palette = "Paired")
house_log <- house_log %>%
mutate(ocean_prox_sarah = if_else(
ocean_proximity %in% c("ISLAND", "NEAR BAY", "NEAR OCEAN"), "NEAR WATER",
ocean_proximity),
ocean_prox_jamie = if_else(
ocean_proximity %in% c("<1H OCEAN", "NEAR BAY", "NEAR OCEAN"), "INLAND"
)
))
house_log <- house_log %>%
mutate(ocean_prox_sarah = if_else(
ocean_proximity %in% c("ISLAND", "NEAR BAY", "NEAR OCEAN"), "NEAR WATER",
ocean_proximity),
ocean_prox_jamie = if_else(
ocean_proximity %in% c("<1H OCEAN", "NEAR BAY", "NEAR OCEAN"), "INLAND"
)
)
View(house_log)
house_augment <- house_augment %>%
mutate(ocean_prox_sarah = if_else(
ocean_proximity %in% c("ISLAND", "NEAR BAY", "NEAR OCEAN"), "NEAR WATER",
ocean_proximity),
ocean_prox_jamie = if_else(
ocean_proximity %in% c("<1H OCEAN", "NEAR BAY", "NEAR OCEAN"), "INLAND"
)
)
house_augment <- house_augment %>%
mutate(ocean_prox_sarah = if_else(
ocean_proximity %in% c("ISLAND", "NEAR BAY", "NEAR OCEAN"), "NEAR WATER",
ocean_proximity),
ocean_prox_jamie = if_else(
ocean_proximity %in% c("<1H OCEAN", "NEAR BAY", "NEAR OCEAN"), "NEAR WATER"
)
)
house_augment <- house_augment %>%
mutate(ocean_prox_sarah = if_else(
ocean_proximity %in% c("ISLAND", "NEAR BAY", "NEAR OCEAN"), "NEAR WATER",
ocean_proximity),
ocean_prox_jamie = if_else(
ocean_proximity %in% c("<1H OCEAN", "NEAR BAY", "NEAR OCEAN"), "NEAR WATER",
ocean_proximity
)
)
ggpairs1 <- house_augment %>%
select(median_house_value, housing_median_age, median_income, ocean_prox_sarah,
ocean_prox_jamie) %>%
ggpairs(fill = ocean_prox_sarah, alpha = 0.5, progress = FALSE)
house_augment
ggpairs1 <- house_augment %>%
select(median_house_value, housing_median_age, median_income, ocean_prox_sarah,
ocean_prox_jamie) %>%
ggpairs(fill = ocean_prox_sarah, alpha = 0.5, progress = FALSE)
house_augment
ggpairs1 <- house_augment %>%
select(median_house_value, housing_median_age, median_income, ocean_prox_sarah,
ocean_prox_jamie) %>%
ggpairs(fill = ocean_prox_sarah, alpha = 0.5, progress = FALSE)
ggpairs1 <- house_augment %>%
select(median_house_value, housing_median_age, median_income, ocean_prox_sarah,
ocean_prox_jamie) %>%
ggpairs(progress = FALSE)
ggpairs1
ggpairs1 <- house_augment %>%
select(median_house_value, housing_median_age, median_income, ocean_prox_sarah,
ocean_prox_jamie) %>%
ggpairs(aes(fill = ocean_prox_sarah, progress = FALSE))
ggpairs1
ggpairs1 <- house_augment %>%
select(median_house_value, housing_median_age, median_income, ocean_prox_sarah,
ocean_prox_jamie) %>%
ggpairs(aes(fill = ocean_prox_sarah), progress = FALSE)
ggpairs1
ggpairs1 <- house_augment %>%
select(median_house_value, housing_median_age, median_income, ocean_prox_sarah,
ocean_prox_jamie) %>%
ggpairs(aes(fill = ocean_prox_sarah, alpha = 0.5), progress = FALSE)
ggpairs1
top50_houses <- houses %>%
slice_max(median_house_value, n = 50)
bottom50_houses <- houses %>%
slice_min(median_house_value, n = 50)
top50_houses <- houses %>%
slice_max(median_house_value, n = 50)
bottom50_houses <- houses %>%
slice_min(median_house_value, n = 50)
leaflet() %>%
addTiles() %>%
addCircles(lng = top11_houses$longitude, lat = top11_houses$latitude) %>%
addCircles(lng = bottom10_houses$longitude, lat = bottom10_houses$latitude,
fillColor = "red", color = "red")
top50_houses <- houses %>%
slice_max(median_house_value, n = 50)
bottom50_houses <- houses %>%
slice_min(median_house_value, n = 50)
leaflet() %>%
addTiles() %>%
addCircles(lng = top50_houses$longitude, lat = top50_houses$latitude) %>%
addCircles(lng = bottom50_houses$longitude, lat = bottom50_houses$latitude,
fillColor = "red", color = "red")
top100_houses <- houses %>%
slice_max(median_house_value, n = 100)
bottom100_houses <- houses %>%
slice_min(median_house_value, n = 100)
leaflet() %>%
addTiles() %>%
addCircles(lng = top100_houses$longitude, lat = top100_houses$latitude) %>%
addCircles(lng = bottom100_houses$longitude, lat = bottom100_houses$latitude,
color = "red")
ggpairs1 <- house_augment %>%
select(median_house_value, housing_median_age, median_income, ocean_prox_sarah,
ocean_prox_jamie) %>%
ggpairs(aes(fill = ocean_prox_sarah, alpha = 0.1), progress = FALSE)
ggpairs1
ggpairs1 <- house_augment %>%
select(median_house_value, housing_median_age, median_income, ocean_prox_sarah,
ocean_prox_jamie) %>%
ggpairs(aes(fill = ocean_prox_sarah, colour = ocean_prox_sarah, alpha = 0.1), progress = FALSE)
ggpairs1
house_augment %>%
select(median_house_value,
log_bedrooms_per_house,
log_bedrooms_per_person,
log_households,
log_prop_bedrooms,
log_total_bedrooms) %>%
ggpairs(aes(fill = ocean_prox_sarah,
colour = ocean_prox_sarah,
alpha = 0.5))
house_augment %>%
select(median_house_value,
log_bedrooms_per_house,
log_bedrooms_per_person,
log_households,
log_prop_bedrooms,
log_total_bedrooms) %>%
ggpairs(aes(fill = ocean_prox_sarah,
color = ocean_prox_sarah,
alpha = 0.5))
house_augment
house_augment %>%
select(median_house_value,
log_bedrooms_per_house,
log_bedrooms_per_person,
log_households,
log_prop_bedrooms,
log_total_bedrooms,
ocean_prox_sarah,
ocean_prox_jamie) %>%
ggpairs(aes(fill = ocean_prox_sarah,
color = ocean_prox_sarah,
alpha = 0.5))
house_augment %>%
select(median_house_value,
log_bedrooms_per_house,
log_bedrooms_per_person,
log_households,
log_prop_bedrooms,
log_total_bedrooms,
ocean_prox_sarah,
ocean_prox_jamie) %>%
ggpairs(aes(fill = ocean_prox_sarah,
color = ocean_prox_sarah,
alpha = 0.5), progress = FALSE)
house_augment %>%
select(median_house_value,
log_bedrooms_per_house,
log_bedrooms_per_person,
log_households,
log_prop_bedrooms,
log_total_bedrooms) %>%
ggpairs(progress = FALSE)
house_augment %>%
select(median_house_value,
log_bedrooms_per_house,
log_bedrooms_per_person,
log_households,
log_prop_bedrooms,
log_total_bedrooms,
ocean_prox_sarah,
ocean_prox_jamie) %>%
ggpairs(aes(fill = ocean_prox_sarah,
color = ocean_prox_sarah,
alpha = 0.5), progress = FALSE)
house_augment %>%
select(median_house_value,
log_bedrooms_per_house,
log_bedrooms_per_person,
log_households,
log_prop_bedrooms,
log_total_bedrooms,
ocean_prox_sarah,
ocean_prox_jamie) %>%
ggpairs(aes(fill = ocean_prox_sarah,
color = ocean_prox_sarah,
alpha = 0.5), progress = FALSE)
house_augment %>%
select(median_house_value,
log_bedrooms_per_house,
log_bedrooms_per_person,
log_households,
log_prop_bedrooms,
log_total_bedrooms,
ocean_prox_sarah,
ocean_prox_jamie) %>%
ggpairs(aes(fill = ocean_prox_sarah,
color = ocean_prox_sarah,
alpha = 0.5), progress = FALSE)
reticulate::repl_python()
mod1a <- lm(log(1 + median_house_value) ~ log(1 + median_income),
data = houses_augment)
mod1a <- lm(log(1 + median_house_value) ~ log(1 + median_income),
data = house_augment)
mod1a
summary(mod1a)
View(house_augment)
View(house_augment)
mod1b <- lm(log(median_house_value) ~ log(median_income),
data = house_augment)
summary(mod1b)
mod1b <- lm(log(1 + median_house_value) ~ ocean_proximity,
data = house_augment)
summary(mod1b)
mod1c <- lm(log(1 + median_house_value) ~ ocean_proximity + log(median_income),
data = house_augment)
summary(mod1c)
mod1b <- lm(median_house_value ~ ocean_proximity,
data = house_augment)
summary(mod1b)
plot(mod1a)
house_log %>%
ggplot() +
aes(x = log(median_income), y= log(median_house_value)) +
geom_point()
house_augment %>%
ggplot() +
aes(x = log(median_income), y= log(median_house_value)) +
geom_point()
library(tidyverse)
library(GGally)
library(ggfortify)
library(fastDummies)
library(mosaic)
library(leaflet)
houses <- read_csv("data/housing_prices.csv")
houses <- houses %>%
mutate(rooms_per_house = total_rooms / households,
people_per_house = population / households,
bedrooms_per_house = total_bedrooms / households,
bedrooms_per_person = total_bedrooms / population,
rooms_per_person = total_rooms / population,
# non_bedrooms = total_rooms - total_bedrooms,
prop_bedrooms = total_bedrooms / total_rooms)
house_log <- houses %>%
select(-c(latitude, longitude, ocean_proximity)) %>%
mutate(across(everything(), .fns = log))
colnames(house_log) <- paste("log", colnames(house_log), sep = "_")
house_augment <- houses %>%
bind_cols(house_log)
house_augment <- house_augment %>%
mutate(ocean_prox_sarah = if_else(
ocean_proximity %in% c("ISLAND", "NEAR BAY", "NEAR OCEAN"), "NEAR WATER",
ocean_proximity),
ocean_prox_jamie = if_else(
ocean_proximity %in% c("<1H OCEAN", "NEAR BAY", "NEAR OCEAN"), "NEAR WATER",
ocean_proximity
)
)
model3 <- lm(median_house_value ~ median_income + ocean_prox_group +
bedrooms_per_house,
data = house_log)
View(house_augment)
model3 <- lm(median_house_value ~ median_income + ocean_prox_group +
bedrooms_per_house,
data = house_augment)
View(house_augment)
model3 <- lm(median_house_value ~ median_income + ocean_prox_jamie +
bedrooms_per_house,
data = house_augment)
summary(model3)
library(modelr)
house_resid <- house_augment %>%
add_residuals(model3)
house_resid %>%
ggplot(aes(x = median_income, y = resid, colour = ocean_prox_jamie)) +
geom_point() +
geom_smooth(method = "lm", se = FALSE)
house_resid %>%
ggplot(aes(x = median_income, y = resid, colour = ocean_prox_jamie)) +
geom_point(alpha = 0.2) +
geom_smooth(method = "lm", se = FALSE)
coplot(resid ~ median_income|bedrooms_per_house,
overlap = FALSE,
panel = function(x, y, ...){
points(x,y)
abline(lm(y~x), col = "blue")
},
data = house_resid)
coplot(resid ~ bedrooms_per_house|median_income,
overlap = FALSE,
panel = function(x, y, ...){
points(x,y)
abline(lm(y~x), col = "blue")
},
data = house_resid)
?coplot
coplot(resid ~ bedrooms_per_house|median_income,
overlap = FALSE,
panel = function(x, y, ...){
points(x,y)
abline(lm(y~x), col = "blue")
},
columns = 6,
data = house_resid)
model4 <- lm(median_house_value ~ median_income + ocean_prox_group +
bedrooms_per_house + median:ocean_prox_group,
data = house_augment)
model4 <- lm(median_house_value ~ median_income + ocean_prox_jamie +
bedrooms_per_house + median:ocean_prox_group,
data = house_augment)
model4 <- lm(median_house_value ~ median_income + ocean_prox_jamie +
bedrooms_per_house + median:ocean_prox_jamie,
data = house_augment)
model4 <- lm(median_house_value ~ median_income + ocean_prox_jamie +
bedrooms_per_house + median_income:ocean_prox_jamie,
data = house_augment)
summary(model4)
model4 <- lm(median_house_value ~ median_income + ocean_prox_jamie +
bedrooms_per_house + median_income:ocean_prox_jamie +
median_income:bedrooms_per_house,
data = house_augment)
summary(model4)
anova(model3, model4)
model4 <- lm(median_house_value ~ median_income + ocean_prox_jamie +
bedrooms_per_house + median_income:ocean_prox_jamie,
data = house_augment)
summary(model4)
anova(model3, model4)
