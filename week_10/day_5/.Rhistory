TRUE ~ p_h
)) %>%
ggplot(aes(alchol)) +
geom_histogram()
white %>%
mutate(alchol = case_when(
alcohol > 1e13 ~ alcohol / 1e12,
alcohol > 1000 ~ alcohol / 10,
TRUE ~ p_h
)) %>%
ggplot(aes(alchol)) +
geom_histogram()
white %>%
mutate(alchol = case_when(
alcohol > 1e13 ~ alcohol / 1e12,
alcohol > 800 ~ alcohol / 10,
TRUE ~ p_h
)) %>%
ggplot(aes(alchol)) +
geom_histogram()
white %>%
mutate(alchol = case_when(
alcohol > 1e13 ~ alcohol / 1e12,
alcohol > 500 ~ alcohol / 10,
TRUE ~ p_h
)) %>%
ggplot(aes(alchol)) +
geom_histogram()
white %>%
mutate(alchol = case_when(
alcohol > 1e13 ~ alcohol / 1e12,
alcohol > 800 ~ alcohol / 10,
TRUE ~ p_h
)) %>%
ggplot(aes(alchol)) +
geom_histogram()
white %>%
mutate(alchol = case_when(
alcohol > 1e13 ~ alcohol / 1e13,
alcohol > 800 ~ alcohol / 10,
TRUE ~ p_h
)) %>%
ggplot(aes(alchol)) +
geom_histogram()
white %>%
mutate(alchol = case_when(
alcohol > 1e13 ~ alcohol / 1e13,
alcohol > 1000 ~ alcohol / 10,
TRUE ~ p_h
)) %>%
ggplot(aes(alchol)) +
geom_histogram()
white %>%
filter(alcohol > 200 & alcohol < 500)
white %>%
filter(alcohol > 200) %>%
fileter(alcohol < 500)
white %>%
filter(alcohol > 200) %>%
filter(alcohol < 500)
white <- read_csv("raw_data/wine_quality_white.csv")
white %>%
ggplot(aes(wine_id, alcohol)) +
geom_point()
white %>%
filter(alcohol > 1e13)
white %>%
filter(alcohol > 1000) %>%
ggplot(aes(wine_id, alcohol)) +
geom_point()
white %>%
filter(alcohol > 1000)
white %>%
filter(alcohol > 1e13)
above_1e13 <- white %>%
filter(alcohol > 1e13)
View(above_1e13)
1e14 / 1e12
1e14 / 1e13
9e14 / 1e13
below_1e13 <- white %>%
filter(alcohol < 1e13)
below_1e13 <- white %>%
filter(alcohol < 1e13) %>%
ggplot(aes(wine_id, alcohol)) +
geom_point()
below_1e13 <- white %>%
filter(alcohol < 1e13)
below_1e13%>%
ggplot(aes(wine_id, alcohol)) +
geom_point()
1000/10
below_500 <- white %>%
filter(alcohol < 500)
below_500%>%
ggplot(aes(wine_id, alcohol)) +
geom_point()
white %>%
mutate(alchol = case_when(
alcohol > 5e14 ~ alcohol / 1e14,
alcohol > 1e14 ~ alcohol / 1e13,
alcohol > 1000 ~ alcohol / 100,
alcohol > 500 ~ alcohol / 10,
alcohol > 100 ~ alcohol / 10,
alcohol > 50 ~ alcohol / 10,
TRUE ~ p_h
)) %>%
ggplot(aes(alchol)) +
geom_histogram()
white %>%
filter(alcohol = start_with(3))
white %>%
filter(alcohol == start_with(3))
white %>%
filter(alcohol == starts_with(3))
above_1e13 <- white %>%
filter(alcohol > 1e13)
below_1e13 <- white %>%
filter(alcohol < 1e13)
below_500 <- white %>%
filter(alcohol < 500)
below_500%>%
ggplot(aes(wine_id, alcohol)) +
geom_point()
below_1e13%>%
ggplot(aes(wine_id, alcohol)) +
geom_point()
below_1e13 <- white %>%
filter(alcohol < 100)
below_1e13 <- white %>%
filter(alcohol < 200)
below_1e13 <- white %>%
filter(alcohol > 200)
View(below_1e13)
white %>%
mutate(alchol = case_when(
alcohol > 5e14 ~ alcohol / 1e14,
alcohol > 1e14 ~ alcohol / 1e13,
alcohol > 1000 ~ alcohol / 100,
alcohol > 500 ~ alcohol / 10,
alcohol > 100 ~ alcohol / 10,
alcohol > 50 ~ alcohol / 10,
TRUE ~ alcohol
)) %>%
ggplot(aes(alchol)) +
geom_histogram()
white %>%
mutate(alchol = case_when(
alcohol > 5e14 ~ alcohol / 1e14,
alcohol > 1e14 ~ alcohol / 1e13,
alcohol > 1000 ~ alcohol / 100,
alcohol > 500 ~ alcohol / 10,
alcohol > 100 ~ alcohol / 10,
alcohol > 50 ~ alcohol / 10,
TRUE ~ alcohol
)) %>%
ggplot(aes(alcohol)) +
geom_histogram()
white %>%
mutate(alchol = case_when(
alcohol > 5e14 ~ alcohol / 1e14,
alcohol > 1e14 ~ alcohol / 1e13,
alcohol > 1000 ~ alcohol / 100,
alcohol > 500 ~ alcohol / 10,
alcohol > 100 ~ alcohol / 10,
alcohol > 50 ~ alcohol / 10,
TRUE ~ alcohol
)) %>%
ggplot(aes(alcohol)) +
geom_histogram()
white %>%
mutate(alcohol = case_when(
alcohol > 5e14 ~ alcohol / 1e14,
alcohol > 1e14 ~ alcohol / 1e13,
alcohol > 1000 ~ alcohol / 100,
alcohol > 500 ~ alcohol / 10,
alcohol > 100 ~ alcohol / 10,
alcohol > 50 ~ alcohol / 10,
TRUE ~ alcohol
)) %>%
ggplot(aes(alcohol)) +
geom_histogram()
View(above_1e13)
new_set <- white %>%
mutate(alcohol = case_when(
alcohol > 5e14 ~ alcohol / 1e14,
alcohol > 1e14 ~ alcohol / 1e13,
alcohol > 1000 ~ alcohol / 100,
alcohol > 500 ~ alcohol / 10,
alcohol > 100 ~ alcohol / 10,
alcohol > 50 ~ alcohol / 10,
TRUE ~ alcohol
))
new_set %>%
filter(alcohol >50)
white %>%
filter(wine_id %in% c(4417, 4484, 4886))
white %>%
mutate(alcohol = case_when(
alcohol > 5e14 ~ alcohol / 1e14,
alcohol > 1e14 ~ alcohol / 1e13,
alcohol > 1000 ~ alcohol / 100,
alcohol > 500 ~ alcohol / 100,
alcohol > 100 ~ alcohol / 10,
alcohol > 50 ~ alcohol / 10,
TRUE ~ alcohol
)) %>%
ggplot(aes(alcohol)) +
geom_histogram()
white <- white %>%
mutate(p_h = case_when(
p_h > 100 ~ p_h / 100,
p_h > 10 ~ p_h / 10,
TRUE ~ p_h
))
white <- white %>%
mutate(alcohol = case_when(
alcohol > 5e14 ~ alcohol / 1e14,
alcohol > 1e14 ~ alcohol / 1e13,
alcohol > 1000 ~ alcohol / 100,
alcohol > 500 ~ alcohol / 100,
alcohol > 100 ~ alcohol / 10,
alcohol > 50 ~ alcohol / 10,
TRUE ~ alcohol
))
# Remove id column
white <- white %>%
select(-wine_id)
View(white)
white %>%
ggplot(aes(fixed_acidity)) +
geom_histogram()
GGally::ggcorr(white,
label = TRUE,
label_round = 2,
label_size = 3,
layout.exp = 0.5,
hjust = 0.8,
size = 3)
white %>%
select(-region) %>%
GGally::ggcorr(white,
label = TRUE,
label_round = 2,
label_size = 3,
layout.exp = 0.5,
hjust = 0.8,
size = 3)
View(white)
no_region <- white %>%
select(-region) %>%
GGally::ggcorr(white,
label = TRUE,
label_round = 2,
label_size = 3,
layout.exp = 0.5,
hjust = 0.8,
size = 3)
no_region <- white %>%
select(-region) %>%
GGally::ggcorr(white,
label = TRUE,
label_round = 2,
label_size = 3,
layout.exp = 0.5,
hjust = 0.8,
size = 3)
select(-region)
no_region <- white %>%
select(-region)
GGally::ggcorr(no_region,
label = TRUE,
label_round = 2,
label_size = 3,
layout.exp = 0.5,
hjust = 0.8,
size = 3)
skimr::skim(white)
white <- read_csv("data/wine_quality_white.csv")
white <- read_csv("raw_data/wine_quality_white.csv")
red <- read_csv("raw_data/wine_quality_red.csv")
white <- read_csv("raw_data/wine_quality_white.csv")
red <- read_csv("raw_data/wine_quality_red.csv")
white_red <- read_csv("raw_data/wine-quality-white-and-red.csv")
4898 + 1599
View(white_red)
View(white)
?left_join
white_trim <- white %>%
select(quality, volatile_acidity, citric_acid, residual_sugar)
quality_join <- left_join(white_red, white, by = c(volatile_acidity, citric_acid, residual_sugar))
white_red <- read_csv("raw_data/wine-quality-white-and-red.csv") %>%
clean_names()
white_red <- read_csv("raw_data/wine-quality-white-and-red.csv") %>%
janitor::clean_names()
quality_join <- left_join(white_red, white, by = c(volatile_acidity, citric_acid, residual_sugar))
View(white_trim)
quality_join <- left_join(white_red, white, by = c(volatile_acidity = volatile_acidity, citric_acid, residual_sugar))
colnames(white_trim)
quality_join <- left_join(white_red, white, by = c(
"volatile_acidity",
"citric_acid", "residual_sugar"))
quality_join <- left_join(white_red, white_trim, by = c(
"volatile_acidity",
"citric_acid", "residual_sugar"))
glimpse(white_trim)
glimpse(white_red)
4898*2
quality_join <- left_join(white_red, white_trim, by = c(
"volatile_acidity",
"citric_acid",
"residual_sugar"))
View(quality_join)
quality_join <- left_join(white_red, white_trim, by = c(
"volatile_acidity",
"citric_acid",
"residual_sugar"))
white_red$volatile_acidity <- round(white_red$volatile_acidity, 3)
white_trim$volatile_acidity <- round(white_trim$volatile_acidity, 3)
white_red$citric_acid <- round(white_red$citric_acid, 2)
white_trim$citric_acid <- round(white_trim$citric_acid, 2)
white_red$residual_sugar <- round(white_red$residual_sugar, 2)
white_trim$residual_sugar <- round(white_trim$residual_sugar, 2)
quality_join <- left_join(white_red, white_trim, by = c(
"volatile_acidity",
"citric_acid",
"residual_sugar"))
white %>%
distinct(residual_sugar)
white %>%
distinct(density)
quality_join <- left_join(white_red, white_trim, by = c(
"volatile_acidity" = "volatile_acidity",
"citric_acid" = "citric_acid",
"residual_sugar" = "residual_sugar"))
quality_join <- left_join(white_red, white_trim, by = c(
"volatile_acidity" = "volatile_acidity",
"citric_acid" = "citric_acid",
"residual_sugar" = "residual_sugar"))
quality_join <- left_join(white_red, white_trim, by = c(
"volatile_acidity" = "volatile_acidity",
"citric_acid" = "citric_acid",
"residual_sugar" = "residual_sugar",
"chlorides" = "chlorides"))
quality_join <- left_join(white_red, white_trim, by = c(
"volatile_acidity" = "volatile_acidity",
"citric_acid" = "citric_acid",
"residual_sugar" = "residual_sugar",
"chlorides" = "chlorides"))
colnames(white_trim)
quality_join <- left_join(white_red, white_trim, by = c(
"volatile_acidity" = "volatile_acidity",
"citric_acid" = "citric_acid",
"residual_sugar" = "residual_sugar",
"chlorides" = "chlorides"))
white_trim <- white %>%
select(quality, volatile_acidity, citric_acid, residual_sugar, chlorides,
density)
quality_join <- left_join(white_red, white_trim, by = c(
"volatile_acidity" = "volatile_acidity",
"citric_acid" = "citric_acid",
"residual_sugar" = "residual_sugar",
"chlorides" = "chlorides",
"density" = "density"))
quality_join <- left_join(white_red, white_trim, by = c(
"volatile_acidity" = "volatile_acidity",
"citric_acid" = "citric_acid",
"residual_sugar" = "residual_sugar",
"chlorides" = "chlorides",
"density" = "density",
"p_h" = "p_h"))
white_trim <- white %>%
select(quality, volatile_acidity, citric_acid, residual_sugar, chlorides,
density, p_h)
quality_join <- left_join(white_red, white_trim, by = c(
"volatile_acidity" = "volatile_acidity",
"citric_acid" = "citric_acid",
"residual_sugar" = "residual_sugar",
"chlorides" = "chlorides",
"density" = "density",
"p_h" = "p_h"))
View(quality_join)
white <- read_csv("raw_data/wine_quality_white.csv")
white <- white %>%
mutate(p_h = case_when(
p_h > 100 ~ p_h / 100,
p_h > 10 ~ p_h / 10,
TRUE ~ p_h
))
white <- white %>%
mutate(alcohol = case_when(
alcohol > 5e14 ~ alcohol / 1e14,
alcohol > 1e14 ~ alcohol / 1e13,
alcohol > 1000 ~ alcohol / 100,
alcohol > 500 ~ alcohol / 100,
alcohol > 100 ~ alcohol / 10,
alcohol > 50 ~ alcohol / 10,
TRUE ~ alcohol
))
white_trim <- white %>%
select(quality, volatile_acidity, citric_acid, residual_sugar, chlorides,
density, p_h, alcohol)
quality_join <- left_join(white_red, white_trim, by = c(
"volatile_acidity" = "volatile_acidity",
"citric_acid" = "citric_acid",
"residual_sugar" = "residual_sugar",
"chlorides" = "chlorides",
"density" = "density",
"p_h" = "p_h",
"alcohol" = "alcohol"))
View(quality_join)
white_red <- read_csv("raw_data/wine-quality-white-and-red.csv") %>%
janitor::clean_names()
skimr::skim(white_red)
alias(lm(quality ~ ., data = white_red))
glimpse(white_red)
white_red %>%
ggplot(aes(quality)) +
geom_density()
GGally::ggcorr(white_red,
label = TRUE,
label_round = 2,
label_size = 3,
layout.exp = 0.5,
hjust = 0.8,
size = 3)
library(ggfortify)
ggpairs(white_red)
library(GGally
library(GGally)
library(GGally)
ggpairs(white_red)
```{r, message = FALSE}
ggpairs(white_red, progress = FALSE)
mod1 <- lm(quality ~ alcohol, data = white_red)
summary(mod1)
autoplot(mod1)
autoplot(mod1)
white_red %>%
add_residuals(mod1) %>%
select(-alcohol, -quality)
white_red %>%
add_residuals(mod1) %>%
select(-alcohol, -quality)
library(modelr)
white_red %>%
add_residuals(mod1) %>%
select(-alcohol, -quality)
white_red %>%
add_residuals(mod1) %>%
select(-alcohol, -quality) %>%
ggpairs(progress = FALSE)
mod2 <- lm(quality ~ alcohol + volatile_acidity, data = white_red)
summary(mod2)
autoplot(mod2)
install.packages("AppliedPredictiveModeling")
library(AppliedPredictiveModeling)
library(tidyverse)
songs <- read_csv("raw_data/song_data.csv")
View(songs)
skimr::skim(songs)
ggplot(songs, aes(song_popularity))
ggplot(songs, aes(song_popularity)) +
geom_histogram()
ggplot(songs, aes(song_popularity)) +
geom_histogram(binwidth = 1)
colnames(songs)
songs %>%
rename(name = song_name)
colnames(songs)
songs <- songs %>%
rename(name = song_name,
popularity = song_popularity,
duration = song_duration_ms)
skimr::skim(songs)
songs %>%
filter(popularity < 2)
songs %>%
filter(popularity < 1)
```{r, message = FALSE}
ggpairs(songs, progress = FALSE)
songs %>%
select(-name) %>%
ggpairs(progress = FALSE)
mod1 <- lm(popularity ~ instrumentalness, data = songs)
summary(mod1)
autoplot(mod1)
ggplot(songs, aes(popularity, instrumentalness)) +
geom_point()
ggplot(songs, aes(popularity, danceability)) +
geom_point()
mod1 <- lm(popularity ~ danceability, data = songs)
summary(mod1)
mod1 <- lm(popularity ~ instrumentalness, data = songs)
summary(mod1)
songs %>%
add_residuals(mod1) %>%
select(-popularity, -instrumentalness)
songs %>%
add_residuals(mod1) %>%
select(-popularity, -instrumentalness) %>%
ggpair(progress = FALSE)
songs %>%
add_residuals(mod1) %>%
select(-popularity, -instrumentalness) %>%
ggpairs(progress = FALSE)
songs %>%
add_residuals(mod1) %>%
select(-popularity, -instrumentalness, -name) %>%
ggpairs(progress = FALSE)
mod2 <- lm(popularity ~ instrumentalness + danceability, data = songs)
summary(mod2)
