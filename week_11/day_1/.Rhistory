library(tidyverse)  # data manipulation
library(cluster)    # clustering algorithms
library(factoextra) # clustering algorithms & visualization
df <- USArrests
df <- na.omit(df)
df <- scale(df)
k2 <- kmeans(df, centers = 2, nstart = 25)
k5 <- kmeans(df, centers = 5, nstart = 25)
str(k2)
df %>%
as_tibble() %>%
mutate(cluster = k2$cluster,
state = row.names(USArrests)) %>%
ggplot(aes(UrbanPop, Murder, color = factor(cluster), label = state)) +
geom_text()
df %>%
as_tibble() %>%
mutate(cluster = k5$cluster,
state = row.names(USArrests)) %>%
ggplot(aes(UrbanPop, Murder, color = factor(cluster), label = state)) +
geom_text()
kmax<-10
WSSus_arrests<-sapply(1:kmax, function(k) kmeans(df, centers = k, nstart = 10)$tot.withinss)
plot(1:kmax, WSSus_arrests, type = 'b', xlab = 'k', ylab = 'Total wss')
abline(v=4, lty=2)
kmax<-10
WSSus_arrests<-sapply(1:kmax, function(k) kmeans(df, centers = k, nstart = 10)$tot.withinss)
plot(1:kmax, WSSus_arrests, type = 'b', xlab = 'k', ylab = 'Total wss')
abline(v=4, lty=2)
k2 <- kmeans(df, centers = 4, nstart = 25)
str(k2)
df %>%
as_tibble() %>%
mutate(cluster = k4$cluster,
state = row.names(USArrests)) %>%
ggplot(aes(UrbanPop, Murder, color = factor(cluster), label = state)) +
geom_text()
k4 <- kmeans(df, centers = 4, nstart = 25)
df %>%
as_tibble() %>%
mutate(cluster = k4$cluster,
state = row.names(USArrests)) %>%
ggplot(aes(UrbanPop, Murder, color = factor(cluster), label = state)) +
geom_text()
df
df %>%
as_tibble() %>%
mutate(cluster = k4$cluster,
state = row.names(USArrests)) %>%
ggplot(aes(Assault, Rape, color = factor(cluster), label = state)) +
geom_text()
p <- plot_ly(df, x=~UrbanPop, y=~Murder,
z=~Assault, color=~cluster) %>%
add_markers(size=1.5)
library(plotly)
p <- plot_ly(df, x=~UrbanPop, y=~Murder,
z=~Assault, color=~cluster) %>%
add_markers(size=1.5)
df <- as.dataframe(df)
?as.data.frame
df <- as.data.frame(df)
View(df)
p <- plot_ly(df, x=~UrbanPop, y=~Murder,
z=~Assault, color=~cluster) %>%
add_markers(size=1.5)
print(p)
df %>%
as_tibble() %>%
mutate(cluster = k4$cluster,
state = row.names(USArrests)) %>%
plot_ly(x=~UrbanPop, y=~Murder,
z=~Assault, color=~cluster)
df %>%
as_tibble() %>%
mutate(cluster = k4$cluster,
state = row.names(USArrests)) %>%
plot_ly(x=~UrbanPop, y=~Murder, z=~Assault,
color=~cluster, label = state)
df %>%
as_tibble() %>%
mutate(cluster = k4$cluster,
state = row.names(USArrests))
df %>%
as_tibble() %>%
mutate(cluster = k4$cluster,
state = row.names(USArrests)) %>%
plot_ly(x=~UrbanPop, y=~Murder, z=~Assault,
color=~cluster, label = state)
df %>%
as_tibble() %>%
mutate(cluster = k4$cluster,
state = row.names(USArrests)) %>%
ggplot(aes(x = Murder, y = UrbanPop, z = Assault,  color = factor(cluster), label = state)) +
geom_text()
df <- df %>%
as_tibble() %>%
mutate(cluster = k4$cluster,
state = row.names(USArrests))
View(df)
p <- plot_ly(df, x=~UrbanPop, y=~Murder, z=~Assault,
color=~cluster, label =~ state) %>%
add_markers(size=1.5)
print(p)
p <- plot_ly(df, x=~UrbanPop, y=~Murder, z=~Assault,
color=~cluster) %>%
add_markers(size=1.5)
print(p)
plot_ly(df, x=~UrbanPop, y=~Murder, z=~Assault,
color=~cluster)
p <- plot_ly(df, x=~UrbanPop, y=~Murder, z=~Assault,
color=~cluster, type = "scatter3d") %>%
add_markers(size=1.5)
print(p)
plot_ly(df, x=~UrbanPop, y=~Murder, z=~Assault,
color=~cluster, type = "scatter3d", mode = markers)
plot_ly(df, x=~UrbanPop, y=~Murder, z=~Assault,
color=~cluster, type = "scatter3d", mode = "markers")
df %>%
as_tibble() %>%
mutate(cluster = k4$cluster,
state = row.names(USArrests)) %>%
ggplot(aes(Assault, Murder, color = factor(cluster), label = state)) +
geom_text()
df <- df %>%
as_tibble() %>%
mutate(cluster = k4$cluster,
state = row.names(USArrests))
plot_ly(df, x = UrbanPop, y = Murder, z = Assault,
color = cluster, type = "scatter3d", mode = "markers")
df <- df %>%
as_tibble() %>%
mutate(cluster = k4$cluster,
state = row.names(USArrests))
plot_ly(df, x~= UrbanPop, y = Murder, z = Assault,
df <- df %>%
as_tibble() %>%
mutate(cluster = k4$cluster,
state = row.names(USArrests))
plot_ly(df, x = "UrbanPop", y = Murder, z = Assault,
color = cluster, type = "scatter3d", mode = "markers")
df <- df %>%
as_tibble() %>%
mutate(cluster = k4$cluster,
state = row.names(USArrests))
plot_ly(df, x = "UrbanPop", y = "Murder", z = "Assault",
color = cluster, type = "scatter3d", mode = "markers")
df <- df %>%
as_tibble() %>%
mutate(cluster = k4$cluster,
state = row.names(USArrests))
plot_ly(df, x = "UrbanPop", y = "Murder", z = "Assault",
color = "cluster", type = "scatter3d", mode = "markers")
df <- df %>%
as_tibble() %>%
mutate(cluster = k4$cluster,
state = row.names(USArrests))
plot_ly(df, x =~ UrbanPop, y =~ Murder, z =~ Assault,
color = cluster, type = "scatter3d", mode = "markers")
View(df)
df <- df %>%
as_tibble() %>%
mutate(cluster = k4$cluster,
state = row.names(USArrests))
plot_ly(df, x=~UrbanPop, y=~Murder, z=~Assault,
color =~ cluster, type = "scatter3d", mode = "markers")
plot_ly(df, x=~UrbanPop, y=~Murder, z=~Assault,
color =~ cluster, type = "scatter3d", mode = "markers", ids = "state")
plot_ly(df, x=~UrbanPop, y=~Murder, z=~Assault,
color =~ cluster, type = "scatter3d", mode = "markers", text = "state")
plot_ly(df, x=~UrbanPop, y=~Murder, z=~Assault,
color =~ cluster, type = "scatter3d", mode = "markers", text = state)
df <- df %>%
as_tibble() %>%
mutate(cluster = k4$cluster,
state = row.names(USArrests))
plot_ly(df, x=~UrbanPop, y=~Murder, z=~Assault,
color =~ cluster, type = "scatter3d", mode = "markers", text = "state")
